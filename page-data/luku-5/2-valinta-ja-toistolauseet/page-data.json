{"componentChunkName":"component---src-templates-course-content-template-js","path":"/luku-5/2-valinta-ja-toistolauseet","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"lead","properties":{},"children":[{"type":"text","value":"Normaalitapauksessa seuraavaksi suoritettava konekäsky on muistissa suorituksessa nyt olevan konekäskyn jälkeen. Valintalauseella suorituspolku voi haarautua jonkin ehdon perusteella kahden tai useamman suoritushaaran välillä. Toistolause tarkoittaa sitä, että sama koodinpätkä suoritetaan uudestaan monta kertaa peräkkäin ja suorituskerrat eroavat yleensä vain yhden muuttujan (ns. muuntelumuuttujan) arvon osalta."}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Ohjelmoinnin peruskäsitteet"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ohjelmoinnissa voidaan ajatella olevan muutama peruskäsite, jotka pitää jollain tavoin toteuttaa. Varsinainen "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"laskentatyö"}]},{"type":"text","value":" on pääasia ja se oikeastaan tarkoittaa yksinkertaisten laskutoimitusten tekoa. Aritmeettis-loogisten lausekkeiden toteutus konekielellä on hyvin suoraviivaista, koska yleisimmin käytetyt aritmeettis-loogiset operaatiot voidaan toteuttaa suoraan niitä vastaavilla konekäskyillä. Pienenä ongelma-alueena tässä on, että kaikki laskenta tapahtuu rekistereiden avulla ja pienen rekisterijoukon optimaalinen käyttö suuren datajoukon laskentaan ei ole ihan helppoa."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"; lausekkeen x = 2x+y toteutus konekielellä\nload r1, x\nmul r1, =2\nadd r1, y\nstore r1, x"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ohjelman "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"kontrolli"}]},{"type":"text","value":" määrittelee, mistä seuraava konekäsky löytyy nyt suorituksessa olevan jälkeen. Oletusarvoisestihan seuraava konekäsky löytyy edellisen jälkeen muistista, mutta usein kontrolli haarautuu muualle ohjelmalogiikan mukaisesti. Tähän liittyy erilaisten koodin suorituspolkujen valinta ja eri tavoin tapahtuva saman koodin suorituksen toisto."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Aliohjelmat"}]},{"type":"text","value":" (funktiot, metodit) ovat oma kategoriansa kontrollin siirron suhteen. Niissä on helposti käytettävää parametrisoitua koodia, jota voidaan käyttää "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"kutsumalla"}]},{"type":"text","value":" mistä tahansa. Aliohjelmat voivat olla kyseisen ohjelmiston omien sisäisten rutiinien lisäksi ohjelmointikielen tai käyttöjärjestelmän palvelurutiineja. Nämä käsitellään seuraavassa luvussa 6."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Käsiteltävä tieto voi olla yksittäisiä sanoja, mutta usein tarvitaan laajempia "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"tietorakenteita"}]},{"type":"text","value":". Yksinkertaisissa tietorakenteissa olevaan tietoon pystytään viittaamaan suoraan konekäskystä sopivan tiedonosoitusmoodin avulla. Monimutkaisessa tietorakenteet ovat sellaisia, joissa viitattavan tiedon osoite pitää laskea usean konekäskyn avulla ennen kuin dataviite voidaan tehdä."}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Valintalauseet korkean tason kielissä"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tyypillisesti kaikissa korkean tason ohjelmointikielissä on ehdollinen \""},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"if ... then ... else ..."}]},{"type":"text","value":"\" kontrollirakenne, jonka avulla valitaan kumpi mahdollisista koodinpätkistä suoritetaan. Tästä on myös yksinkertaisempi \""},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"if ... then"}]},{"type":"text","value":"\" muoto, jossa then-haaran koodi suoritetaan vain, jos annettu ehto on voimassa. Sen jälkeen suoritus jatkuu normaalisti \""},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"if ... then"}]},{"type":"text","value":"\" lauseen jälkeisessä koodissa joka tapauksessa."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Joissakin ohjelmointikielissä on myös ns. "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"switch"}]},{"type":"text","value":" tai "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"case"}]},{"type":"text","value":" lause, jolla mahdollinen suorituspolku valitaan useamman vaihtoehdon väliltä. Esimerkiksi C-kielen switch-lauseella voidaan suoritettava koodinpätkä valita sen mukaan, mikä jonkin lausekkeen arvo tällä hetkellä on. Lisäksi mukana on oletusarvo vaihtoehto, joka valitaan silloin kun mikään erikseen nimetty vaihtoehto ei toteutunut."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"switch(error-number)  {\n    case 1: ... ; break;\n    case 2: ... ; break;\n    case 8: ... ; break;\n    default: ...\n    }"}]}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Valintalauseet konekielessä"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Konekielessä valintalauseet toteutetaan yksinkertaisesti ehdollisilla hyppykäskyillä."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"      load r1, X\n      jnzer r1, xnzer       ; jos r1 != 0, hyppää kohtaan xnzer \n      ...                   ; then-haara\n      jump done\nxnzer ...                   ; else-haara\ndone  nop"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Monivalinta tehdään tyypillisesti vain vertailemalla lausekkeen arvoa eri vaihtoehtoihin"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"     load r1, X\n     comp r1, =1\n     jnequ not1\n     ...           ; vaihtoehto X=1\n     jump done\nnot1 comp r1, =2\n     jnequ not2\n     ...           ; vaihtoehto X=2\n     jump done\nnot2 comp r1, =3\n     jnequ not3\n     ...           ; vaihtoehto X=3\n     jump done\nnot3 ...           ; oletus vaihtoehto (default)\ndone nop"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tämä on tietenkin aika hidasta, kun keskimäärin pitää puolet vaihtoehdoista käydä läpi ennen oikean löytämistä. Oikean vaihtoedon löytämistä voi nopeuttaa, jos laittaa todennäköisimmät vaihtoehdot ensin, mutta tämä ei useinkaan ole mahdollista. Hyvin kätevä korkean tason kielen rakenne muuttuu siis aika kömpelöksi konekieliseksi toteutukseksi."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Joissakin tapauksissa monivalinta voidaan toteuttaa ns. "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"hyppytaulun"}]},{"type":"text","value":" (jump table) avulla. Hyppytaulussa on talletettuna eri vaihtoehtojen "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"hyppyosoitteet"}]},{"type":"text","value":", joista yksi valitaan haarautumisehdon perusteella. Hyppytaulun huonona puolena on, että sen pitää kattaa kaikki ehtolausekkeen mahdolliset arvot."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"JumpT  ds 10   ; oleta arvoalue 0-9\n\n; --- eri vaihtoehtoihin liittyvät koodit\ncase1   ...      ; vaihtoehto X=1\n        jump done\ncase2   ...      ; vaihtoehto X=2\n        jump done\ncase8   ...      ; vaihtoehto X=8\n        jump done\ncaseD   ...      ; oletus vaihtoehto (default)\n        jump done\n\n; --- hyppytaulun JumpT alustus\n        ...     ; alusta kaikkiin arvo caseD\n\n        load r1, =case1   ; muuta vaihtoon 1 liittyvä osoite\n        load r2, =1\n        store r1, JumpT(r2)\n\n        load r1, =case2\n        load r2, =2\n        store r1, JumpT(r2)\n\n        load r1, =case8\n        load r2, =8\n        store r1, JumpT(r2)\n\n; --- halutun vaihtoehdon valinta\n        ; tässä pitäisi ehkä tarkistaa, onko X:n arvo ok!\n        load r1, X\n        load r2, Jump(r1)   ; oikean vaihtoehdon osoite\n        jump 0(r2)\ndone    nop"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Toinen vaihtoehto on, että hyppytaulussa onkin eri vaihtoehtoihin johtavat "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"hyppykäskyt"}]},{"type":"text","value":", joista yksi valitaan suoritukseen haarautumisehdon perusteella. Taulun alustus ja vaihtoehdon valinta tapahtuvat nyt tietenkin vähän eri tavalla."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"; --- halutun vaihtoehdon valinta\n        load r1, X\n        jump r2, JumpT(r1) ; hyppää oikeaan vaihtoehtoon hyppäävään käskyyn\ndone    nop"}]}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Toistolauseet korkean tason kielissä"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Korkean tason kielissä on tyypillisesti muutama erityyppinen toistolause. Toistolauseiden tyyppejä on useanlaisia, koska joihinkin tapauksiin ongelman ratkaisu on helpompaa tietyn tyyppisellä toistolauseella kuin jollakin toisella."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For-silmukassa muuntelumuuttujalle annetaan alkuarvo, sen muutoksen ilmaisema lauseke ja silmukan lopetusehto. Joissakin kielissä sallitaan myös usean muuntelumuuttujan käyttö."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"for (i=0; i++; i<30) {    /* i++ on sama kuin i=i+1, C tai Java */\n    A[i] = 4*i;\n    }"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Useimmissa kielissä ehtolauseke tarkistetaan ennen silmukan koodin suorittamista ja tällöin on mahdollista, että silmukan koodia ("},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"runkoa"}]},{"type":"text","value":") ei suoriteta lainkaan. Joissakin kielissä ehtolauseke tarkistetaan vasta silmukan koodin suorittamisen jälkeen. Tuolloin silmukan koodi suoritetaan aina vähintään yhden kerran."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"   do 50 i = 0, 30, 1      /* Fortran */\n   A[i] = 4*i;\n50 continue"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Toinen tyypillinen toistolause on \""},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"while-do"}]},{"type":"text","value":"\" silmukka, jossa silmukkaa suoritetaan kunnes jokin ehto tulee voimaan. Muuntelumuuttujia voi tällöin olla silmukassa useitakin, mutta ne täytyy alustaa while-lauseen ulkopuolella."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"i=0; j= 50;\nwhile (i<j) do {          /* C tai Java */\n    x = T[i];\n    T[i] = T[j];\n    T[j] = x;\n    i++; j++;\n    }"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tästäkin on muoto, jossa silmukan runko suoritetaan ainakin kerran. Siitä käytetään esimerkiksi nimiä \""},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"do-while"}]},{"type":"text","value":"\", \""},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"do-until"}]},{"type":"text","value":"\" tai \""},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"repeat-until"}]},{"type":"text","value":"\" silmukka, ohjelmointikielestä riippuen."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"i=0; j= 50;\ndo {                           /* C Sharp */\n    x = T[i];\n    T[i] = T[j];\n    T[j] = x;\n    i++; j++;\n    }\nuntil i>j;"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Eri ohjelmointikielissä on vielä paljon muitakin toistolauseen muotoja, mutta yleensä ne ovat näiden neljän muunnoksia. Saman näköisilläkin toistolauseilla voi olla eri ohjelmointikielissä erilainen merkitys ("},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"semantiikka"}]},{"type":"text","value":"). Joissakin ohjelmointikielissä silmukan rungosta tai koko silmukasta voi poistua esim. "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"exit"}]},{"type":"text","value":"-lauseella. Joissakin ohjelmointikielissä voi silmukan yhteydessä määritellä uusia muuttujia, jotka ovat olemassa ja viitattavissa vain tuon silmukan sisällä. Emme käsittele näitä silmukoiden erityispiirteitä tässä sen enempää."}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Toistolauseet konekielessä"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Konekielessä toistolauseita on vain kahden tyyppisiä. Molemmissa alustetaan ensin mahdolliset muuntelumuuttujat. Ensimmäisessä tapauksessa tarkistetaan heti, josko silmukasta poistutaan tällä hetkellä. Jos ei poistuta, niin silmukan runko suoritetaan ja sen jälkeen tehdään mahdolliset muutokset muuntelumuuttujiin. Toisessa vaihtoehdossa silmukan runko ja muutokset muuuntelumuuttujiin suoritetaan ensin ja sitten vasta testataan silmukan päättymisehtoa. Näillä kahdella vaihtoehdolla voidaan toteuttaa kaikki korkean tason kielten toistolauseet. Totta kai varsinaisessa konekielisessä toteutuksessa pitää huomioida kunkin korkean tason kielen semanttiset erityispiirteet."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Esimerkiksi, edellä oleva C-kielen taulukon alustus for-silmukalla voitaisiin toteuttaa konekielellä seuraavasti:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"      load r1, =0       ;  muuntelumuuttujan i alustus, arvo r1:ssä\nloop  comp r1, =30      ; silmukan lopetustesti\n      jequ done\n      load r2, r1       ; silmukan runko\n      mul  r2, =4\n      store r2, A(r1)\n      add r1, =1        ; lisätään muuntelumuuttujan i arvoa yhdellä, arvo r1:ssä\n      jump loop\ndone  nop               ; poistu silmukasta"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vastaavasti edellä oleva Fortran-kielinen do-silmukka (\"do 50\") olisi konekielellä:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"      load r1, =0       ;  muuntelumuuttujan i alustus, arvo r1:ssä\nloop  load r2, r1       ; silmukan runko\n      mul  r2, =4\n      store r2, A(r1)\n      add r1, =1        ; lisätään muuntelumuuttujan i arvoa yhdellä, arvo r1:ssä\n      comp r1, =30      ; silmukan lopetustesti\n      jless loop"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vaikka silmukat näyttävät kovin samanlaisilta, niissä on merkittävä semanttinen ero. Ei ole ollenkaan yhdentekevää, testataanko silmukan lopetusehto ennen ensimmäistä silmukan rungon suorituskertaa vai ei."}]},{"type":"comment","value":" quiz 5.2.?? ???? "},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"93b2b40e-35bc-5560-a186-0fd849650b3c"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"2aa12732-f5b2-5f8e-8136-07e2ee36797b"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"31eeba76-4d99-5402-9aba-65fd0ef551d2"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"17cb7c26-d844-506d-ac0e-6e56eb7d897c"},"children":[]}]}]},"html":"<div><div>\n<lead>Normaalitapauksessa seuraavaksi suoritettava konekäsky on muistissa suorituksessa nyt olevan konekäskyn jälkeen. Valintalauseella suorituspolku voi haarautua jonkin ehdon perusteella kahden tai useamman suoritushaaran välillä. Toistolause tarkoittaa sitä, että sama koodinpätkä suoritetaan uudestaan monta kertaa peräkkäin ja suorituskerrat eroavat yleensä vain yhden muuttujan (ns. muuntelumuuttujan) arvon osalta.</lead>\n</div><h2>Ohjelmoinnin peruskäsitteet</h2><p>Ohjelmoinnissa voidaan ajatella olevan muutama peruskäsite, jotka pitää jollain tavoin toteuttaa. Varsinainen <em>laskentatyö</em> on pääasia ja se oikeastaan tarkoittaa yksinkertaisten laskutoimitusten tekoa. Aritmeettis-loogisten lausekkeiden toteutus konekielellä on hyvin suoraviivaista, koska yleisimmin käytetyt aritmeettis-loogiset operaatiot voidaan toteuttaa suoraan niitä vastaavilla konekäskyillä. Pienenä ongelma-alueena tässä on, että kaikki laskenta tapahtuu rekistereiden avulla ja pienen rekisterijoukon optimaalinen käyttö suuren datajoukon laskentaan ei ole ihan helppoa.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">; lausekkeen x = 2x+y toteutus konekielellä\nload r1, x\nmul r1, =2\nadd r1, y\nstore r1, x</code></pre></div><p>Ohjelman <em>kontrolli</em> määrittelee, mistä seuraava konekäsky löytyy nyt suorituksessa olevan jälkeen. Oletusarvoisestihan seuraava konekäsky löytyy edellisen jälkeen muistista, mutta usein kontrolli haarautuu muualle ohjelmalogiikan mukaisesti. Tähän liittyy erilaisten koodin suorituspolkujen valinta ja eri tavoin tapahtuva saman koodin suorituksen toisto.</p><p><em>Aliohjelmat</em> (funktiot, metodit) ovat oma kategoriansa kontrollin siirron suhteen. Niissä on helposti käytettävää parametrisoitua koodia, jota voidaan käyttää <em>kutsumalla</em> mistä tahansa. Aliohjelmat voivat olla kyseisen ohjelmiston omien sisäisten rutiinien lisäksi ohjelmointikielen tai käyttöjärjestelmän palvelurutiineja. Nämä käsitellään seuraavassa luvussa 6.</p><p>Käsiteltävä tieto voi olla yksittäisiä sanoja, mutta usein tarvitaan laajempia <em>tietorakenteita</em>. Yksinkertaisissa tietorakenteissa olevaan tietoon pystytään viittaamaan suoraan konekäskystä sopivan tiedonosoitusmoodin avulla. Monimutkaisessa tietorakenteet ovat sellaisia, joissa viitattavan tiedon osoite pitää laskea usean konekäskyn avulla ennen kuin dataviite voidaan tehdä.</p><h2>Valintalauseet korkean tason kielissä</h2><p>Tyypillisesti kaikissa korkean tason ohjelmointikielissä on ehdollinen \"<em>if ... then ... else ...</em>\" kontrollirakenne, jonka avulla valitaan kumpi mahdollisista koodinpätkistä suoritetaan. Tästä on myös yksinkertaisempi \"<em>if ... then</em>\" muoto, jossa then-haaran koodi suoritetaan vain, jos annettu ehto on voimassa. Sen jälkeen suoritus jatkuu normaalisti \"<em>if ... then</em>\" lauseen jälkeisessä koodissa joka tapauksessa.</p><p>Joissakin ohjelmointikielissä on myös ns. <em>switch</em> tai <em>case</em> lause, jolla mahdollinen suorituspolku valitaan useamman vaihtoehdon väliltä. Esimerkiksi C-kielen switch-lauseella voidaan suoritettava koodinpätkä valita sen mukaan, mikä jonkin lausekkeen arvo tällä hetkellä on. Lisäksi mukana on oletusarvo vaihtoehto, joka valitaan silloin kun mikään erikseen nimetty vaihtoehto ei toteutunut.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">switch(error-number)  {\n    case 1: ... ; break;\n    case 2: ... ; break;\n    case 8: ... ; break;\n    default: ...\n    }</code></pre></div><h2>Valintalauseet konekielessä</h2><p>Konekielessä valintalauseet toteutetaan yksinkertaisesti ehdollisilla hyppykäskyillä.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">      load r1, X\n      jnzer r1, xnzer       ; jos r1 != 0, hyppää kohtaan xnzer \n      ...                   ; then-haara\n      jump done\nxnzer ...                   ; else-haara\ndone  nop</code></pre></div><p>Monivalinta tehdään tyypillisesti vain vertailemalla lausekkeen arvoa eri vaihtoehtoihin</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">     load r1, X\n     comp r1, =1\n     jnequ not1\n     ...           ; vaihtoehto X=1\n     jump done\nnot1 comp r1, =2\n     jnequ not2\n     ...           ; vaihtoehto X=2\n     jump done\nnot2 comp r1, =3\n     jnequ not3\n     ...           ; vaihtoehto X=3\n     jump done\nnot3 ...           ; oletus vaihtoehto (default)\ndone nop</code></pre></div><p>Tämä on tietenkin aika hidasta, kun keskimäärin pitää puolet vaihtoehdoista käydä läpi ennen oikean löytämistä. Oikean vaihtoedon löytämistä voi nopeuttaa, jos laittaa todennäköisimmät vaihtoehdot ensin, mutta tämä ei useinkaan ole mahdollista. Hyvin kätevä korkean tason kielen rakenne muuttuu siis aika kömpelöksi konekieliseksi toteutukseksi.</p><p>Joissakin tapauksissa monivalinta voidaan toteuttaa ns. <em>hyppytaulun</em> (jump table) avulla. Hyppytaulussa on talletettuna eri vaihtoehtojen <em>hyppyosoitteet</em>, joista yksi valitaan haarautumisehdon perusteella. Hyppytaulun huonona puolena on, että sen pitää kattaa kaikki ehtolausekkeen mahdolliset arvot.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">JumpT  ds 10   ; oleta arvoalue 0-9\n\n; --- eri vaihtoehtoihin liittyvät koodit\ncase1   ...      ; vaihtoehto X=1\n        jump done\ncase2   ...      ; vaihtoehto X=2\n        jump done\ncase8   ...      ; vaihtoehto X=8\n        jump done\ncaseD   ...      ; oletus vaihtoehto (default)\n        jump done\n\n; --- hyppytaulun JumpT alustus\n        ...     ; alusta kaikkiin arvo caseD\n\n        load r1, =case1   ; muuta vaihtoon 1 liittyvä osoite\n        load r2, =1\n        store r1, JumpT(r2)\n\n        load r1, =case2\n        load r2, =2\n        store r1, JumpT(r2)\n\n        load r1, =case8\n        load r2, =8\n        store r1, JumpT(r2)\n\n; --- halutun vaihtoehdon valinta\n        ; tässä pitäisi ehkä tarkistaa, onko X:n arvo ok!\n        load r1, X\n        load r2, Jump(r1)   ; oikean vaihtoehdon osoite\n        jump 0(r2)\ndone    nop</code></pre></div><p>Toinen vaihtoehto on, että hyppytaulussa onkin eri vaihtoehtoihin johtavat <em>hyppykäskyt</em>, joista yksi valitaan suoritukseen haarautumisehdon perusteella. Taulun alustus ja vaihtoehdon valinta tapahtuvat nyt tietenkin vähän eri tavalla.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">; --- halutun vaihtoehdon valinta\n        load r1, X\n        jump r2, JumpT(r1) ; hyppää oikeaan vaihtoehtoon hyppäävään käskyyn\ndone    nop</code></pre></div><h2>Toistolauseet korkean tason kielissä</h2><p>Korkean tason kielissä on tyypillisesti muutama erityyppinen toistolause. Toistolauseiden tyyppejä on useanlaisia, koska joihinkin tapauksiin ongelman ratkaisu on helpompaa tietyn tyyppisellä toistolauseella kuin jollakin toisella.</p><p>For-silmukassa muuntelumuuttujalle annetaan alkuarvo, sen muutoksen ilmaisema lauseke ja silmukan lopetusehto. Joissakin kielissä sallitaan myös usean muuntelumuuttujan käyttö.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">for (i=0; i++; i&lt;30) {    /* i++ on sama kuin i=i+1, C tai Java */\n    A[i] = 4*i;\n    }</code></pre></div><p>Useimmissa kielissä ehtolauseke tarkistetaan ennen silmukan koodin suorittamista ja tällöin on mahdollista, että silmukan koodia (<em>runkoa</em>) ei suoriteta lainkaan. Joissakin kielissä ehtolauseke tarkistetaan vasta silmukan koodin suorittamisen jälkeen. Tuolloin silmukan koodi suoritetaan aina vähintään yhden kerran.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">   do 50 i = 0, 30, 1      /* Fortran */\n   A[i] = 4*i;\n50 continue</code></pre></div><p>Toinen tyypillinen toistolause on \"<em>while-do</em>\" silmukka, jossa silmukkaa suoritetaan kunnes jokin ehto tulee voimaan. Muuntelumuuttujia voi tällöin olla silmukassa useitakin, mutta ne täytyy alustaa while-lauseen ulkopuolella.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">i=0; j= 50;\nwhile (i&lt;j) do {          /* C tai Java */\n    x = T[i];\n    T[i] = T[j];\n    T[j] = x;\n    i++; j++;\n    }</code></pre></div><p>Tästäkin on muoto, jossa silmukan runko suoritetaan ainakin kerran. Siitä käytetään esimerkiksi nimiä \"<em>do-while</em>\", \"<em>do-until</em>\" tai \"<em>repeat-until</em>\" silmukka, ohjelmointikielestä riippuen.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">i=0; j= 50;\ndo {                           /* C Sharp */\n    x = T[i];\n    T[i] = T[j];\n    T[j] = x;\n    i++; j++;\n    }\nuntil i&gt;j;</code></pre></div><p>Eri ohjelmointikielissä on vielä paljon muitakin toistolauseen muotoja, mutta yleensä ne ovat näiden neljän muunnoksia. Saman näköisilläkin toistolauseilla voi olla eri ohjelmointikielissä erilainen merkitys (<em>semantiikka</em>). Joissakin ohjelmointikielissä silmukan rungosta tai koko silmukasta voi poistua esim. <em>exit</em>-lauseella. Joissakin ohjelmointikielissä voi silmukan yhteydessä määritellä uusia muuttujia, jotka ovat olemassa ja viitattavissa vain tuon silmukan sisällä. Emme käsittele näitä silmukoiden erityispiirteitä tässä sen enempää.</p><h2>Toistolauseet konekielessä</h2><p>Konekielessä toistolauseita on vain kahden tyyppisiä. Molemmissa alustetaan ensin mahdolliset muuntelumuuttujat. Ensimmäisessä tapauksessa tarkistetaan heti, josko silmukasta poistutaan tällä hetkellä. Jos ei poistuta, niin silmukan runko suoritetaan ja sen jälkeen tehdään mahdolliset muutokset muuntelumuuttujiin. Toisessa vaihtoehdossa silmukan runko ja muutokset muuuntelumuuttujiin suoritetaan ensin ja sitten vasta testataan silmukan päättymisehtoa. Näillä kahdella vaihtoehdolla voidaan toteuttaa kaikki korkean tason kielten toistolauseet. Totta kai varsinaisessa konekielisessä toteutuksessa pitää huomioida kunkin korkean tason kielen semanttiset erityispiirteet.</p><p>Esimerkiksi, edellä oleva C-kielen taulukon alustus for-silmukalla voitaisiin toteuttaa konekielellä seuraavasti:</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">      load r1, =0       ;  muuntelumuuttujan i alustus, arvo r1:ssä\nloop  comp r1, =30      ; silmukan lopetustesti\n      jequ done\n      load r2, r1       ; silmukan runko\n      mul  r2, =4\n      store r2, A(r1)\n      add r1, =1        ; lisätään muuntelumuuttujan i arvoa yhdellä, arvo r1:ssä\n      jump loop\ndone  nop               ; poistu silmukasta</code></pre></div><p>Vastaavasti edellä oleva Fortran-kielinen do-silmukka (\"do 50\") olisi konekielellä:</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">      load r1, =0       ;  muuntelumuuttujan i alustus, arvo r1:ssä\nloop  load r2, r1       ; silmukan runko\n      mul  r2, =4\n      store r2, A(r1)\n      add r1, =1        ; lisätään muuntelumuuttujan i arvoa yhdellä, arvo r1:ssä\n      comp r1, =30      ; silmukan lopetustesti\n      jless loop</code></pre></div><p>Vaikka silmukat näyttävät kovin samanlaisilta, niissä on merkittävä semanttinen ero. Ei ole ollenkaan yhdentekevää, testataanko silmukan lopetusehto ennen ensimmäistä silmukan rungon suorituskertaa vai ei.</p><!-- quiz 5.2.?? ???? --><div><quiz id=\"93b2b40e-35bc-5560-a186-0fd849650b3c\"></quiz></div>\n<div><quiz id=\"2aa12732-f5b2-5f8e-8136-07e2ee36797b\"></quiz></div>\n<div><quiz id=\"31eeba76-4d99-5402-9aba-65fd0ef551d2\"></quiz></div>\n<div><quiz id=\"17cb7c26-d844-506d-ac0e-6e56eb7d897c\"></quiz></div></div>","frontmatter":{"path":"/luku-5/2-valinta-ja-toistolauseet","title":"Ohjelmoinnin peruskäsitteet sekä valinta- ja toistolauseiden toteutus"}},"allPages":{"edges":[{"node":{"id":"799b0272-abdf-59f0-b9b3-03947af42427","frontmatter":{"path":"/credits","title":"Tekijänoikeudet ja lisenssit"}}},{"node":{"id":"5b6302a2-c64b-508c-91c4-2db0957cc4b2","frontmatter":{"path":"/arvostelu-ja-kokeet","title":"Arvostelu ja kokeet"}}},{"node":{"id":"82621c5a-f915-50d4-828d-8eede35fdbf7","frontmatter":{"path":"/opettajille","title":"Opettajille ja opinto-ohjaajille"}}},{"node":{"id":"6ed176ef-1be8-53dc-8513-8c4e14a7ce38","frontmatter":{"path":"/osaamistavoitteet","title":"Osaamistavoitteet"}}},{"node":{"id":"2d5ef803-9204-51b7-8d1b-891f29cac1ab","frontmatter":{"path":"/tukivaylat","title":"Tukiväylät"}}},{"node":{"id":"62fa7239-7639-50e3-accb-d209fb4f0984","frontmatter":{"path":"/","title":""}}},{"node":{"id":"9374d347-238d-5d15-a799-d9e134097e9c","frontmatter":{"path":"/usein-kysytyt-kysymykset","title":"Usein kysytyt kysymykset"}}},{"node":{"id":"25d93020-25bf-51eb-97b6-bdc2d0248ede","frontmatter":{"path":"/luku-10/1-tulkitseminen-ohjelman-suoritustapana","title":"Tulkitseminen ohjelman suoritustapana"}}},{"node":{"id":"a49be168-fcf3-5169-95ff-fbb93911c744","frontmatter":{"path":"/luku-10/3-java-ohjelmien-suoritustavat","title":"Java-ohjelmien suoritustavat"}}},{"node":{"id":"96acc546-7537-5245-af40-c0a343f43e57","frontmatter":{"path":"/luku-10/2-java-virtuaalikone","title":"Java virtuaalikone (JVM)"}}},{"node":{"id":"4e1f7d23-545a-578e-8502-1c016428d15a","frontmatter":{"path":"/luku-10/4-emulointi-suorittimen-toteutustapana","title":"Emulointi suorittimen toteutustapana"}}},{"node":{"id":"cc1cb9ab-8bc3-59eb-b373-ef1ef4682363","frontmatter":{"path":"/luku-10","title":"Luku 10: Tulkinta ja emulointi"}}},{"node":{"id":"22e14f18-d591-5b76-bc01-38d14cd680c5","frontmatter":{"path":"/luku-5/1-ttk-91","title":"Esimerkkitietokone ttk-91"}}},{"node":{"id":"d4832ed4-06c4-5023-94dd-c56d9b3c41aa","frontmatter":{"path":"/luku-5/2-valinta-ja-toistolauseet","title":"Ohjelmoinnin peruskäsitteet sekä valinta- ja toistolauseiden toteutus"}}},{"node":{"id":"adc41c13-389b-5ce4-a479-0caa5271449e","frontmatter":{"path":"/luku-5/4-optimoitu-koodi","title":"Optimoitu koodi"}}},{"node":{"id":"668ae475-1d6e-51a8-a31a-18fda782eae4","frontmatter":{"path":"/luku-5/3-rakenteinen-tieto","title":"Rakenteisen tiedon toteutus ja siihen viittaaminen"}}},{"node":{"id":"0ad1f9dc-df1c-5319-aab2-35699e72ce91","frontmatter":{"path":"/luku-5/5-titokone-titotrainer","title":"Titokone ja TitoTrainer"}}},{"node":{"id":"2373db22-c9f3-579a-83a5-7da1843c4181","frontmatter":{"path":"/luku-5","title":"Luku 5: Konekielinen ohjelmointi"}}},{"node":{"id":"9fb3f792-821e-5683-b13f-aa15c30ea444","frontmatter":{"path":"/luku-6/1-aliohjelmat","title":"Aliohjelmat, parametrityypit, aktivaatiotietue (AT)"}}},{"node":{"id":"b2137737-4997-5b6f-9c79-f81a20870ffe","frontmatter":{"path":"/luku-6/2-akt-tiet-rakentaminen","title":"Aktivaatiotietueen rakentaminen"}}},{"node":{"id":"d73cb6c1-d9fa-55c6-be7f-55c899bef652","frontmatter":{"path":"/luku-6/3-viiteparametrit","title":"Viiteparametrit ja ulostuloparametrit"}}},{"node":{"id":"6b15a20b-2879-57a1-b9a2-321c9c0bdeee","frontmatter":{"path":"/luku-6/4-kj-palvelut","title":"Käyttöjärjestelmäpalvelujen käyttö"}}},{"node":{"id":"9dd0cfca-308d-52e9-b7c9-87bd80b1e3ec","frontmatter":{"path":"/luku-6","title":"Luku 6: Aliohjelmien toteutus"}}},{"node":{"id":"550311b6-6492-58a1-ac20-c4c6ded21215","frontmatter":{"path":"/luku-7/1-vika-virhe-hairio","title":"Vika, virhe ja häiriö"}}},{"node":{"id":"d078f99d-62b5-5564-ba0d-0db0a1a125e9","frontmatter":{"path":"/luku-7/3-muisti-cache-ssd","title":"Järjestelmän sisäisten muistien toteutus"}}},{"node":{"id":"ea808cef-5af4-5657-a911-c57be158f85f","frontmatter":{"path":"/luku-7/2-tiedon-muuttumattomuus","title":"Tiedon muuttumattomuuden turvaaminen"}}},{"node":{"id":"416d64ce-5ffe-5e05-ba25-661028cbe13b","frontmatter":{"path":"/luku-7","title":"Luku 7: Tiedon muuttumattomuus ja erilaiset muistit"}}},{"node":{"id":"e0ee5976-ad00-5b27-8809-adc036d067bc","frontmatter":{"path":"/luku-8/1-muistihierarkia","title":"Muistihierarkia ja virtuaalimuisti"}}},{"node":{"id":"1ceaef01-e5c2-58d4-8898-e980f9d6ac9a","frontmatter":{"path":"/luku-8/2-tiedostot-massamuisti","title":"Tiedostojärjestelmä, tiedostot ja massamuisti"}}},{"node":{"id":"9b30c941-92d6-56de-9b5a-d476a488677a","frontmatter":{"path":"/luku-8/3-io-toteutus","title":"I/O:n toteutus"}}},{"node":{"id":"7967b05d-f768-543f-9069-20c79559cf74","frontmatter":{"path":"/luku-8","title":"Luku 8: Ulkoisen muistin käyttö ja I/O:n toteutus"}}},{"node":{"id":"a4421758-c50f-5cad-8743-46b4fa6d731f","frontmatter":{"path":"/luku-9/1-lausekielesta-suoritukseen","title":"Lausekielestä suoritukseen"}}},{"node":{"id":"d5e20fce-1056-5299-8c49-8e44bc54cdfc","frontmatter":{"path":"/luku-9/2-kaantaminen","title":"Kääntäminen"}}},{"node":{"id":"285cf4c9-0cf8-500b-848d-ad9d9a76ce11","frontmatter":{"path":"/luku-9/3-linkitys","title":"Linkitys"}}},{"node":{"id":"22e4b1ba-4ba7-5aad-98b6-0d4778090bca","frontmatter":{"path":"/luku-9/4-lataus","title":"Lataus"}}},{"node":{"id":"a18c72ea-cb8c-5f68-826e-b2e4ade4c972","frontmatter":{"path":"/luku-9","title":"Luku 9: Käännös, linkitys ja lataus"}}}]}},"pageContext":{}},"staticQueryHashes":["2283872788","994120085"]}